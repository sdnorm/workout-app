<div class="space-y-6">
  <h1 class="text-2xl font-bold">Edit Preferences</h1>

  <%= form_with model: @preference, url: preferences_path, method: :patch, class: "space-y-6" do |f| %>

    <%# Equipment %>
    <div class="bg-gray-900 rounded-xl border border-gray-800 p-4 space-y-3">
      <h2 class="font-semibold text-gray-200">Home Equipment</h2>
      <p class="text-sm text-gray-400">Select equipment available at your home gym.</p>
      <div class="grid grid-cols-2 gap-2">
        <% UserPreference::EQUIPMENT_OPTIONS.each do |key, label| %>
          <label class="flex items-center gap-2 px-3 py-2 rounded-lg bg-gray-800 border border-gray-700 cursor-pointer hover:border-gray-600">
            <%= check_box_tag "user_preference[home_equipment][]", key,
              @preference.home_equipment.include?(key),
              class: "rounded bg-gray-700 border-gray-600 text-blue-500 focus:ring-blue-500" %>
            <span class="text-sm text-gray-300"><%= label %></span>
          </label>
        <% end %>
      </div>
      <div>
        <label class="block text-sm font-medium text-gray-300 mb-1">Equipment Notes</label>
        <%= f.text_area :equipment_notes, rows: 2,
          placeholder: "e.g., Dumbbells go up to 52.5 lbs each",
          class: "w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 text-gray-100 placeholder-gray-500 text-sm" %>
      </div>
    </div>

    <%# Training Goal %>
    <div class="bg-gray-900 rounded-xl border border-gray-800 p-4 space-y-3">
      <h2 class="font-semibold text-gray-200">Training Goal</h2>
      <%= f.select :training_goal,
        [["Hypertrophy (Muscle Growth)", "hypertrophy"], ["Strength", "strength"], ["Recomposition", "recomp"], ["Cut (Fat Loss)", "cut"]],
        {},
        class: "w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 text-gray-100" %>
    </div>

    <%# Muscle Group Priorities %>
    <div class="bg-gray-900 rounded-xl border border-gray-800 p-4 space-y-3">
      <h2 class="font-semibold text-gray-200">Muscle Group Priorities</h2>
      <p class="text-sm text-gray-400">Priority muscles get more volume; maintenance muscles get less.</p>
      <div class="grid grid-cols-1 gap-2">
        <% @muscle_groups.each do |mg| %>
          <div class="flex items-center justify-between px-3 py-2 rounded-lg bg-gray-800 border border-gray-700">
            <span class="text-sm font-medium text-gray-300"><%= mg.name %></span>
            <%= select_tag "user_preference[muscle_group_priorities][#{mg.name}]",
              options_for_select(
                [["Normal", "normal"], ["Priority", "priority"], ["Maintenance", "maintenance"]],
                @preference.priority_for(mg.name)
              ),
              class: "bg-gray-700 border border-gray-600 rounded-lg px-2 py-1 text-sm text-gray-100" %>
          </div>
        <% end %>
      </div>
    </div>

    <%# Style Preferences %>
    <div class="bg-gray-900 rounded-xl border border-gray-800 p-4 space-y-3">
      <h2 class="font-semibold text-gray-200">Workout Style</h2>
      <div class="grid grid-cols-2 gap-2">
        <% UserPreference::STYLE_OPTIONS.each do |key, label| %>
          <label class="flex items-center gap-2 px-3 py-2 rounded-lg bg-gray-800 border border-gray-700 cursor-pointer hover:border-gray-600">
            <%= check_box_tag "user_preference[workout_style][]", key,
              @preference.workout_style.include?(key),
              class: "rounded bg-gray-700 border-gray-600 text-blue-500 focus:ring-blue-500" %>
            <span class="text-sm text-gray-300"><%= label %></span>
          </label>
        <% end %>
      </div>
      <div>
        <label class="block text-sm font-medium text-gray-300 mb-1">Style Notes</label>
        <%= f.text_area :style_notes, rows: 2,
          placeholder: "e.g., I like to keep rest periods short",
          class: "w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 text-gray-100 placeholder-gray-500 text-sm" %>
      </div>
    </div>

    <%# Injuries %>
    <div class="bg-gray-900 rounded-xl border border-gray-800 p-4 space-y-3">
      <h2 class="font-semibold text-gray-200">Injuries & Limitations</h2>
      <%= f.text_area :injuries_notes, rows: 3,
        placeholder: "e.g., Bad left shoulder â€” avoid overhead pressing",
        class: "w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 text-gray-100 placeholder-gray-500 text-sm" %>
    </div>

    <div class="flex gap-3">
      <%= f.submit "Save Preferences", class: "flex-1 bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 rounded-lg transition cursor-pointer" %>
      <%= link_to "Cancel", preferences_path, class: "flex-1 bg-gray-700 hover:bg-gray-600 text-white font-semibold py-3 rounded-lg transition text-center" %>
    </div>
  <% end %>
</div>
