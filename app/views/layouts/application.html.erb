<!DOCTYPE html>
<html class="h-full bg-gray-950">
  <head>
    <title><%= content_for(:title) || "RP Trainer" %></title>
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="application-name" content="RP Trainer">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#030712">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>
    <%= yield :head %>
    <%= tag.link rel: "manifest", href: pwa_manifest_path(format: :json) %>
    <link rel="icon" href="/icon.png" type="image/png">
    <link rel="apple-touch-icon" href="/icon.png">
    <%= stylesheet_link_tag :app, "data-turbo-track": "reload" %>
    <%= javascript_importmap_tags %>
  </head>

  <body class="h-full text-gray-100">
    <% if authenticated? %>
      <div class="min-h-full pb-20">
        <% if notice.present? || alert.present? %>
          <div class="px-4 pt-4">
            <% if notice.present? %>
              <div class="rounded-lg bg-green-900/50 border border-green-700 p-3 text-sm text-green-200 mb-2">
                <%= notice %>
              </div>
            <% end %>
            <% if alert.present? %>
              <div class="rounded-lg bg-red-900/50 border border-red-700 p-3 text-sm text-red-200 mb-2">
                <%= alert %>
              </div>
            <% end %>
          </div>
        <% end %>

        <main class="px-4 py-4">
          <%= yield %>
        </main>

        <!-- Bottom Navigation -->
        <nav class="fixed bottom-0 left-0 right-0 bg-gray-900 border-t border-gray-800 safe-area-bottom">
          <div class="flex justify-around items-center h-16">
            <%= link_to workouts_path, class: "flex flex-col items-center justify-center w-full h-full #{request.path.start_with?('/workouts') || request.path == '/' ? 'text-blue-400' : 'text-gray-500'}" do %>
              <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/></svg>
              <span class="text-xs mt-1">Workout</span>
            <% end %>
            <%= link_to runs_path, class: "flex flex-col items-center justify-center w-full h-full #{request.path.start_with?('/runs') ? 'text-blue-400' : 'text-gray-500'}" do %>
              <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"/></svg>
              <span class="text-xs mt-1">Runs</span>
            <% end %>
            <%= link_to mesocycles_path, class: "flex flex-col items-center justify-center w-full h-full #{request.path.start_with?('/mesocycles') ? 'text-blue-400' : 'text-gray-500'}" do %>
              <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"/></svg>
              <span class="text-xs mt-1">Program</span>
            <% end %>
            <%= link_to profile_path, class: "flex flex-col items-center justify-center w-full h-full #{request.path.start_with?('/profile') ? 'text-blue-400' : 'text-gray-500'}" do %>
              <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/></svg>
              <span class="text-xs mt-1">Profile</span>
            <% end %>
          </div>
        </nav>
      </div>
    <% else %>
      <main class="min-h-full flex flex-col items-center justify-center px-4">
        <% if notice.present? %>
          <div class="w-full max-w-sm mb-4 rounded-lg bg-green-900/50 border border-green-700 p-3 text-sm text-green-200">
            <%= notice %>
          </div>
        <% end %>
        <% if alert.present? %>
          <div class="w-full max-w-sm mb-4 rounded-lg bg-red-900/50 border border-red-700 p-3 text-sm text-red-200">
            <%= alert %>
          </div>
        <% end %>
        <%= yield %>
      </main>
    <% end %>
  </body>
</html>
